
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RSA Cryptography (Educational)</title>
  <link rel="stylesheet" href="../../assets/styles.css" />
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="logo"></div>
      <h1>RSA Cryptography</h1>
      <nav class="nav">
        <a href="../classical/index.html">Classical</a>
        <a href="index.html">RSA</a>
        <a href="../misc/index.html">Misc</a>
      </nav>
    </header>

    <section class="card" aria-label="RSA keygen">
      <h3>1) Generate small RSA keys</h3>
      <div class="controls">
        <label class="small">Prime p</label>
        <input type="number" id="rsa-p" value="61" />
        <label class="small">Prime q</label>
        <input type="number" id="rsa-q" value="53" />
        <label class="small">Public exponent e (optional)</label>
        <input type="number" id="rsa-e" value="65537" />
        <button class="btn primary" id="rsa-make">Make Keys</button>
      </div>
      <p class="small">n = p×q, φ(n) = (p−1)(q−1). d is the modular inverse of e mod φ(n).</p>
      <div class="grid">
        <div class="card"><p><strong>n</strong>: <span id="rsa-n"></span></p></div>
        <div class="card"><p><strong>φ(n)</strong>: <span id="rsa-phi"></span></p></div>
        <div class="card"><p><strong>e</strong>: <span id="rsa-e-out"></span></p></div>
        <div class="card"><p><strong>d</strong>: <span id="rsa-d"></span></p></div>
      </div>
      <div class="alert small" id="rsa-alert" aria-live="polite"></div>
    </section>

    <section class="card" aria-label="RSA encrypt">
      <h3>2) Encrypt / Decrypt an integer message</h3>
      <label class="small">Message m (integer less than n)</label>
      <input type="number" id="rsa-m" value="65" />
      <div class="controls">
        <button class="btn primary" id="rsa-do-encrypt">Encrypt</button>
        <button class="btn" id="rsa-do-decrypt">Decrypt</button>
      </div>
      <p><strong>ciphertext c</strong>: <span id="rsa-c"></span></p>
      <p><strong>decrypted m</strong>: <span id="rsa-m-out"></span></p>
      <p class="small alert">This demo uses tiny primes—never use for real security.</p>
    </section>

    <footer class="footer"><small>RSA invented in 1977. Demo only.</small></footer>
  </div>
  <script src="../../assets/site.js"></script>
  <script>
    let currentKeys = null;
    function makeKeys(){
      const p = parseInt(byId('rsa-p').value,10);
      const q = parseInt(byId('rsa-q').value,10);
      const eInput = parseInt(byId('rsa-e').value,10);
      if(!isPrime(p) || !isPrime(q)) { setText('rsa-alert','p and q must be primes.'); return; }
      const keys = rsaKey(p, q, eInput);
      if(keys.d === null){ setText('rsa-alert','Failed to compute d: e must be coprime with φ(n). Try another e.'); return; }
      setText('rsa-alert','');
      currentKeys = keys;
      setText('rsa-n', String(keys.n));
      setText('rsa-phi', String(keys.phiN));
      setText('rsa-e-out', String(keys.e));
      setText('rsa-d', String(keys.d));
    }
    function doEncrypt(){ if(!currentKeys){ makeKeys(); }
      const m = parseInt(byId('rsa-m').value,10);
      if(!currentKeys) return;
      if(m >= currentKeys.n){ setText('rsa-alert','Message m must be less than n.'); return; }
      const c = rsaEncrypt(m, currentKeys.e, currentKeys.n);
      setText('rsa-c', String(c));
    }
    function doDecrypt(){ if(!currentKeys){ makeKeys(); }
      if(!currentKeys) return;
      const cTxt = byId('rsa-c').textContent;
      if(!cTxt){ setText('rsa-alert','Encrypt first to get ciphertext.'); return; }
      const c = BigInt(cTxt);
      const mOut = rsaDecrypt(c, currentKeys.d, currentKeys.n);
      setText('rsa-m-out', String(mOut));
    }
    byId('rsa-make').addEventListener('click', makeKeys);
    byId('rsa-do-encrypt').addEventListener('click', doEncrypt);
    byId('rsa-do-decrypt').addEventListener('click', doDecrypt);
  </script>
</body>
</html>
